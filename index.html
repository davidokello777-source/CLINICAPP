<!DOCTYPE html>
<html>
<head>
<title>TALI MEDICALS - Clinic Management System</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial; margin:0; background:#f0fdf4; }
header { background:#166534; color:white; padding:15px; text-align:center; }
nav { background:#15803d; padding:10px; display:flex; gap:10px; flex-wrap:wrap; }
nav button { padding:8px 12px; border:none; background:#22c55e; color:white; cursor:pointer; border-radius:6px; }
nav button:hover { background:#16a34a; }
section { padding:20px; display:none; }
table { width:100%; border-collapse: collapse; margin-top:10px; background:white; }
table, th, td { border:1px solid #ddd; }
th, td { padding:8px; text-align:left; }
input, select { padding:6px; margin:5px; }
.card { background:white; padding:15px; margin:10px 0; box-shadow:0 2px 6px rgba(0,0,0,0.1); border-radius:10px; }
.cards { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:15px; }
.login { display:flex; justify-content:center; align-items:center; height:100vh; }
.login-box { background:white; padding:30px; box-shadow:0 0 10px #aaa; border-radius:8px; }
.hidden { display:none; }
.alert { color:red; font-weight:bold; }
</style>
</head>
<body>

<div id="loginPage" class="login">
<div class="login-box">
<h3>TALI MEDICALS Login</h3>
<select id="roleSelect">
<option value="Director">Director</option>
<option value="Reception">Reception</option>
<option value="Dental">Dental Doctor</option>
<option value="ENT">ENT Doctor</option>
<option value="General">General Doctor</option>
<option value="Lab">Lab Technician</option>
<option value="Pharmacy">Pharmacist</option>
</select><br>
<input type="password" id="password" placeholder="Password"><br>
<button onclick="login()">Login</button>
</div>
</div>

<div id="app" class="hidden">
<header>
<h2>TALI MEDICALS - Clinic System</h2>
<div id="userInfo"></div>
</header>

<nav id="nav"></nav>

<section id="dashboard">
<h3>Dashboard</h3>
<div class="cards">
<div class="card">Total Patients: <span id="totalPatients">0</span></div>
<div class="card">Open Visits: <span id="openVisits">0</span></div>
<div class="card">Total Revenue: $<span id="totalRevenue">0</span></div>
</div>
</section>

<section id="patients">
<h3>Patient Registration</h3>
<input id="pname" placeholder="Full Name">
<input id="page" type="number" placeholder="Age">
<select id="pgender"><option>Male</option><option>Female</option></select>
<button onclick="savePatient()">Save</button>
<table id="patientTable"></table>
</section>

<section id="visits">
<h3>Open Visit</h3>
<input id="visitPatient" placeholder="Patient Name">
<select id="visitDept">
<option>Dental</option>
<option>ENT</option>
<option>General</option>
</select>
<button onclick="openVisit()">Open Visit</button>
<table id="visitTable"></table>
</section>

<section id="consultation">
<h3>Consultation</h3>
<input id="consVisit" placeholder="Visit ID">
<textarea id="diagnosis" placeholder="Diagnosis"></textarea><br>
<input id="procedure" placeholder="Procedure (optional)">
<button onclick="saveConsultation()">Save Consultation</button>
</section>

<section id="lab">
<h3>Laboratory</h3>
<input id="labVisit" placeholder="Visit ID">
<input id="labTest" placeholder="Test Name">
<button onclick="orderLab()">Order Test</button>
<input id="labResultVisit" placeholder="Visit ID">
<input id="labResult" placeholder="Result">
<button onclick="saveLabResult()">Save Result</button>
</section>

<section id="pharmacy">
<h3>Pharmacy</h3>
<input id="drugName" placeholder="Drug Name">
<input id="drugQty" type="number" placeholder="Quantity">
<button onclick="addDrug()">Add Drug</button>
<table id="drugTable"></table>
</section>

<section id="billing">
<h3>Billing</h3>
<input id="billVisit" placeholder="Visit ID">
<input id="billAmount" type="number" placeholder="Amount">
<select id="billType">
<option>Cash</option>
<option>Mobile Money</option>
</select>
<button onclick="addPayment()">Add Payment</button>
<table id="billTable"></table>
</section>

</div>

<script>
let role="";
let patients=[];
let visits=[];
let consultations=[];
let labs=[];
let drugs=[];
let payments=[];

function login(){
if(password.value!=="1234"){alert("Wrong password");return;}
role=roleSelect.value;
loginPage.classList.add("hidden");
app.classList.remove("hidden");
userInfo.innerText="Logged in as: "+role;
setupNav();
show("dashboard");
}

function setupNav(){
nav.innerHTML="";
nav.innerHTML+=`<button onclick="show('dashboard')">Dashboard</button>`;
nav.innerHTML+=`<button onclick="show('patients')">Patients</button>`;
nav.innerHTML+=`<button onclick="show('visits')">Visits</button>`;
nav.innerHTML+=`<button onclick="show('consultation')">Consultation</button>`;
nav.innerHTML+=`<button onclick="show('lab')">Lab</button>`;
nav.innerHTML+=`<button onclick="show('pharmacy')">Pharmacy</button>`;
nav.innerHTML+=`<button onclick="show('billing')">Billing</button>`;
}

function show(id){
document.querySelectorAll("section").forEach(s=>s.style.display="none");
document.getElementById(id).style.display="block";
updateDashboard();
}

function generateID(prefix,array){
return prefix+"-"+(array.length+1).toString().padStart(5,'0');
}

function savePatient(){
let id=generateID("PAT",patients);
patients.push({id,name:pname.value,age:page.value,gender:pgender.value});
renderPatients();
}

function renderPatients(){
patientTable.innerHTML="<tr><th>ID</th><th>Name</th><th>Age</th><th>Gender</th></tr>";
patients.forEach(p=>{
patientTable.innerHTML+=`<tr><td>${p.id}</td><td>${p.name}</td><td>${p.age}</td><td>${p.gender}</td></tr>`;
});
}

function openVisit(){
let id=generateID("VIS",visits);
visits.push({id,patient:visitPatient.value,dept:visitDept.value,status:"Open"});
renderVisits();
}

function renderVisits(){
visitTable.innerHTML="<tr><th>ID</th><th>Patient</th><th>Dept</th><th>Status</th></tr>";
visits.forEach(v=>{
visitTable.innerHTML+=`<tr><td>${v.id}</td><td>${v.patient}</td><td>${v.dept}</td><td>${v.status}</td></tr>`;
});
}

function saveConsultation(){
consultations.push({visit:consVisit.value,diagnosis:diagnosis.value,procedure:procedure.value});
}

function orderLab(){
labs.push({visit:labVisit.value,test:labTest.value,status:"Pending"});
}

function saveLabResult(){
labs.forEach(l=>{
if(l.visit===labResultVisit.value){l.result=labResult.value;l.status="Done";}
});
}

function addDrug(){
drugs.push({name:drugName.value,qty:drugQty.value});
renderDrugs();
}

function renderDrugs(){
drugTable.innerHTML="<tr><th>Name</th><th>Qty</th></tr>";
drugs.forEach(d=>{
drugTable.innerHTML+=`<tr><td>${d.name}</td><td>${d.qty}</td></tr>`;
});
}

function addPayment(){
payments.push({visit:billVisit.value,amount:parseFloat(billAmount.value)});
renderPayments();
}

function renderPayments(){
billTable.innerHTML="<tr><th>Visit</th><th>Amount</th></tr>";
payments.forEach(p=>{
billTable.innerHTML+=`<tr><td>${p.visit}</td><td>${p.amount}</td></tr>`;
});
}

function updateDashboard(){
totalPatients.innerText=patients.length;
openVisits.innerText=visits.filter(v=>v.status==="Open").length;
totalRevenue.innerText=payments.reduce((s,p)=>s+p.amount,0);
}
</script>

</body>
</html>
