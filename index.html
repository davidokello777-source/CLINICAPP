<!DOCTYPE html>
<html>
<head>
    <title>Dental & ENT Clinic System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: Arial; margin:0; background:#f1f5f9; }
        header { background:#0f172a; color:white; padding:15px; text-align:center; }
        nav { background:#1e293b; padding:10px; display:flex; gap:10px; flex-wrap:wrap; }
        nav button { padding:8px 12px; border:none; background:#3b82f6; color:white; cursor:pointer; border-radius:6px; }
        nav button:hover { background:#2563eb; }
        section { padding:20px; display:none; }
        table { width:100%; border-collapse: collapse; margin-top:10px; background:white; }
        table, th, td { border:1px solid #ddd; }
        th, td { padding:8px; text-align:left; }
        input, select { padding:6px; margin:5px; }
        .card { background:white; padding:15px; margin:10px 0; box-shadow:0 2px 8px rgba(0,0,0,0.1); border-radius:10px; }
        .cards { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:15px; }
        .login { display:flex; justify-content:center; align-items:center; height:100vh; }
        .login-box { background:white; padding:30px; box-shadow:0 0 10px #aaa; border-radius:8px; }
        .hidden { display:none; }
        .alert { color:red; font-weight:bold; }
    </style>
</head>
<body>

<div id="loginPage" class="login">
    <div class="login-box">
        <h3>Clinic Login</h3>
        <select id="role">
            <option value="Director">Medical Director</option>
            <option value="Doctor">Doctor</option>
            <option value="Receptionist">Receptionist</option>
            <option value="Pharmacist">Pharmacist</option>
        </select><br>
        <input type="password" id="password" placeholder="Password"><br>
        <button onclick="login()">Login</button>
    </div>
</div>

<div id="app" class="hidden">

<header>
    <h2>Dental & ENT Management System</h2>
    <div id="userInfo"></div>
</header>

<nav id="nav"></nav>

<section id="dashboard">
    <h3>Dashboard</h3>
    <div>
        Branch:
        <select id="branchSelect" onchange="renderAll()">
            <option value="Main">Main Branch</option>
            <option value="Branch2">Future Branch</option>
        </select>
    </div>
    <div class="cards">
        <div class="card">Patients: <span id="totalPatients">0</span></div>
        <div class="card">Inventory Items: <span id="totalItems">0</span></div>
        <div class="card">Revenue: $<span id="totalRevenue">0</span></div>
    </div>
</section>

<section id="patients">
    <h3>Register Patient</h3>
    <input id="pname" placeholder="Name">
    <input id="page" placeholder="Age">
    <button onclick="addPatient()">Add</button>

    <h4>Patients</h4>
    <table id="patientTable"></table>
</section>

<section id="inventory">
    <h3>Add Inventory</h3>
    <input id="iname" placeholder="Item Name">
    <input id="iqty" type="number" placeholder="Quantity">
    <input id="iexp" type="date">
    <button onclick="addItem()">Add</button>

    <h4>Inventory</h4>
    <table id="inventoryTable"></table>
</section>

<section id="billing">
    <h3>Create Invoice</h3>
    <input id="bpatient" placeholder="Patient Name">
    <input id="bamount" type="number" placeholder="Amount">
    <button onclick="addBill()">Add</button>

    <h4>Invoices</h4>
    <table id="billingTable"></table>
</section>

<section id="settings">
    <h3>System Settings</h3>
    <button onclick="resetData()">Reset All Data</button>
</section>

</div>

<script>
let role="";
let patients=JSON.parse(localStorage.getItem("patients"))||[];
let inventory=JSON.parse(localStorage.getItem("inventory"))||[];
let bills=JSON.parse(localStorage.getItem("bills"))||[];

function login(){
    if(password.value!=="1234"){alert("Wrong password");return;}
    role=role.value;
    loginPage.classList.add("hidden");
    app.classList.remove("hidden");
    userInfo.innerText="Logged in as: "+role;
    setupNav();
    show("dashboard");
}

function setupNav(){
    nav.innerHTML="";
    nav.innerHTML+=`<button onclick="show('dashboard')">Dashboard</button>`;
    if(role!=="Doctor") nav.innerHTML+=`<button onclick="show('patients')">Patients</button>`;
    if(role==="Director"||role==="Pharmacist") nav.innerHTML+=`<button onclick="show('inventory')">Inventory</button>`;
    if(role!=="Doctor") nav.innerHTML+=`<button onclick="show('billing')">Billing</button>`;
    if(role==="Director") nav.innerHTML+=`<button onclick="show('settings')">Settings</button>`;
    nav.innerHTML+=`<button onclick="logout()">Logout</button>`;
}

function logout(){location.reload();}

function show(id){
    document.querySelectorAll("section").forEach(s=>s.style.display="none");
    document.getElementById(id).style.display="block";
    renderAll();
}

function currentBranch(){return branchSelect.value;}

function addPatient(){
    patients.push({name:pname.value,age:page.value,branch:currentBranch()});
    localStorage.setItem("patients",JSON.stringify(patients));
    renderAll();
}

function addItem(){
    inventory.push({name:iname.value,qty:parseInt(iqty.value),exp:iexp.value,branch:currentBranch()});
    localStorage.setItem("inventory",JSON.stringify(inventory));
    renderAll();
}

function addBill(){
    bills.push({patient:bpatient.value,amount:parseFloat(bamount.value),branch:currentBranch()});
    localStorage.setItem("bills",JSON.stringify(bills));
    renderAll();
}

function renderAll(){
    renderPatients();
    renderInventory();
    renderBills();
    updateDashboard();
}

function renderPatients(){
    patientTable.innerHTML="<tr><th>Name</th><th>Age</th><th>Action</th></tr>";
    patients.filter(p=>p.branch===currentBranch()).forEach((p,i)=>{
        patientTable.innerHTML+=`<tr><td>${p.name}</td><td>${p.age}</td><td><button onclick="deletePatient(${i})">X</button></td></tr>`;
    });
}

function renderInventory(){
    inventoryTable.innerHTML="<tr><th>Item</th><th>Qty</th><th>Expiry</th><th>Status</th><th>Action</th></tr>";
    inventory.filter(i=>i.branch===currentBranch()).forEach((item,i)=>{
        let status=item.qty<5?"<span class='alert'>Low Stock</span>":"OK";
        inventoryTable.innerHTML+=`<tr><td>${item.name}</td><td>${item.qty}</td><td>${item.exp}</td><td>${status}</td><td><button onclick="deleteItem(${i})">X</button></td></tr>`;
    });
}

function renderBills(){
    billingTable.innerHTML="<tr><th>Patient</th><th>Amount</th><th>Action</th></tr>";
    bills.filter(b=>b.branch===currentBranch()).forEach((b,i)=>{
        billingTable.innerHTML+=`<tr><td>${b.patient}</td><td>${b.amount}</td><td><button onclick="deleteBill(${i})">X</button></td></tr>`;
    });
}

function updateDashboard(){
    totalPatients.innerText=patients.filter(p=>p.branch===currentBranch()).length;
    totalItems.innerText=inventory.filter(i=>i.branch===currentBranch()).length;
    totalRevenue.innerText=bills.filter(b=>b.branch===currentBranch()).reduce((s,b)=>s+b.amount,0);
}

function deletePatient(i){patients.splice(i,1);localStorage.setItem("patients",JSON.stringify(patients));renderAll();}
function deleteItem(i){inventory.splice(i,1);localStorage.setItem("inventory",JSON.stringify(inventory));renderAll();}
function deleteBill(i){bills.splice(i,1);localStorage.setItem("bills",JSON.stringify(bills));renderAll();}

function resetData(){
    if(confirm("Reset all data?")){
        localStorage.clear();
        location.reload();
    }
}
</script>

</body>
</html>
